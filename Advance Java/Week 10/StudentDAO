import java.sql.*;
class StudentDAO {
    private String url = "jdbc:mysql://localhost:3306/studentdb";
    private String user = "root";
    private String password = "Rishi@1212";

    public boolean insertStudent(Student s) {
        boolean isInserted = false;

        try {
            Connection con = DriverManager.getConnection(url, user, password);

        String sql = "INSERT INTO student VALUES (?, ?, ?)";

        PreparedStatement ps = con.prepareStatement(sql);

        ps.setInt(1, s.getId());
        ps.setString(2, s.getName());
        ps.setInt(3, s.getTotalMarks());

        int rows = ps.executeUpdate();

        if(rows > 0) {
            isInserted = true;
        }

        con.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

        return isInserted;
    }

    public void getAllStudents() {
        try {
            Connection con = DriverManager.getConnection(url, user, password);

            String sql = "SELECT * FROM student";

            PreparedStatement ps = con.prepareStatement(sql);

            ResultSet rs = ps.executeQuery();

            while(rs.next()) {
                int id = rs.getInt("id");
                String name = rs.getString("name");
                int marks = rs.getInt("marks");

                System.out.println(id + " | " + name + " | " + marks);
            }

            con.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}